<!DOCTYPE html>

<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CXAS Payment System</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <style>
    :root {
      --brand:   #0057B8;
      --brand2:  #0072E5;
      --accent:  #00B4D8;
      --dark:    #0A1628;
      --dark2:   #142240;
      --white:   #ffffff;
      --cream:   #F4F7FB;
      --gray:    #6B7A99;
      --border:  #DDE3EF;
      --success: #059669;
      --warn:    #D97706;
      --danger:  #DC2626;
      --radius:  10px;
      --shadow:  0 2px 20px rgba(10,22,40,0.10);
      --shadow-lg: 0 8px 40px rgba(10,22,40,0.15);
    }

```
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

body {
  font-family: 'Inter', sans-serif;
  background: var(--cream);
  color: var(--dark);
  min-height: 100vh;
}

/* â”€â”€ NAV â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
nav {
  background: var(--dark);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 2rem;
  height: 62px;
  position: sticky;
  top: 0;
  z-index: 100;
  box-shadow: 0 2px 16px rgba(0,0,0,0.25);
}
.nav-logo {
  display: flex;
  align-items: center;
  gap: 12px;
}
.nav-logo img {
  height: 36px;
  width: auto;
  display: block;
}
.nav-logo-fallback {
  font-family: 'Manrope', sans-serif;
  color: white;
  font-size: 1.05rem;
  font-weight: 700;
}
.nav-logo-sep {
  width: 1px;
  height: 28px;
  background: rgba(255,255,255,0.15);
}
.nav-product {
  font-family: 'Manrope', sans-serif;
  color: rgba(255,255,255,0.65);
  font-size: 0.85rem;
  font-weight: 500;
  letter-spacing: 0.02em;
}
.nav-right {
  display: flex;
  align-items: center;
  gap: 1rem;
}
.nav-user-pill {
  background: rgba(255,255,255,0.08);
  border: 1px solid rgba(255,255,255,0.12);
  border-radius: 20px;
  padding: 4px 14px;
  font-size: 0.78rem;
  color: rgba(255,255,255,0.65);
  display: none;
  max-width: 200px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* â”€â”€ GEAR / API CONFIG BUTTON (always visible in nav) â”€â”€ */
#gear-btn {
  background: rgba(255,255,255,0.08);
  border: 1.5px solid rgba(255,255,255,0.18);
  border-radius: 8px;
  padding: 6px 14px;
  color: white;
  cursor: pointer;
  font-size: 0.8rem;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 7px;
  transition: background 0.2s;
  font-family: 'Inter', sans-serif;
}
#gear-btn:hover { background: rgba(255,255,255,0.16); }
.gear-dot {
  width: 7px; height: 7px;
  border-radius: 50%;
  background: #ef4444;
  flex-shrink: 0;
}
.gear-dot.ok { background: #22c55e; }

/* â”€â”€ MODAL BACKDROP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.modal-backdrop {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(10,22,40,0.65);
  backdrop-filter: blur(4px);
  z-index: 500;
  align-items: center;
  justify-content: center;
  padding: 1rem;
}
.modal-backdrop.open { display: flex; }
.modal {
  background: var(--dark);
  border-radius: 16px;
  width: 100%;
  max-width: 490px;
  box-shadow: var(--shadow-lg);
  border: 1px solid rgba(255,255,255,0.08);
  animation: modalIn 0.25s ease;
}
@keyframes modalIn { from { transform: translateY(14px); opacity:0; } to { transform:none; opacity:1; } }
.modal-header {
  padding: 1.4rem 1.6rem 1rem;
  border-bottom: 1px solid rgba(255,255,255,0.08);
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.modal-header h3 {
  font-family: 'Manrope', sans-serif;
  color: white;
  font-size: 1rem;
  font-weight: 700;
}
.modal-close {
  background: rgba(255,255,255,0.07);
  border: none;
  color: rgba(255,255,255,0.45);
  cursor: pointer;
  width: 28px; height: 28px;
  border-radius: 6px;
  font-size: 1rem;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background 0.15s;
}
.modal-close:hover { background: rgba(255,255,255,0.14); color: white; }
.modal-body { padding: 1.4rem 1.6rem; }
.modal-footer { padding: 0 1.6rem 1.4rem; }

.demo-notice {
  background: rgba(0,180,216,0.09);
  border: 1px solid rgba(0,180,216,0.22);
  border-radius: 9px;
  padding: 0.8rem 1rem;
  font-size: 0.77rem;
  color: rgba(255,255,255,0.6);
  line-height: 1.65;
  margin-bottom: 1.2rem;
}
.demo-notice strong { color: var(--accent); }

.cfg-status-row {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 0.77rem;
  color: rgba(255,255,255,0.4);
  padding: 0.55rem 0.85rem;
  background: rgba(255,255,255,0.03);
  border-radius: 7px;
  margin-bottom: 1.1rem;
  border: 1px solid rgba(255,255,255,0.06);
}
.status-dot { width: 8px; height: 8px; border-radius: 50%; background: #ef4444; flex-shrink: 0; }
.status-dot.ok { background: #22c55e; }

.cfg-field { margin-bottom: 1rem; }
.cfg-field label {
  display: block;
  font-size: 0.7rem;
  font-weight: 700;
  color: rgba(255,255,255,0.4);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  margin-bottom: 0.38rem;
}
.cfg-field input {
  width: 100%;
  background: rgba(255,255,255,0.06);
  border: 1.5px solid rgba(255,255,255,0.1);
  border-radius: 8px;
  padding: 0.62rem 0.9rem;
  color: white;
  font-family: 'Inter', monospace;
  font-size: 0.81rem;
  outline: none;
  transition: border-color 0.2s;
}
.cfg-field input:focus { border-color: var(--accent); background: rgba(255,255,255,0.08); }
.cfg-field input::placeholder { color: rgba(255,255,255,0.18); }
.cfg-hint { font-size: 0.7rem; color: rgba(255,255,255,0.25); margin-top: 0.28rem; line-height: 1.55; }

.btn-save {
  width: 100%;
  background: linear-gradient(135deg, var(--brand), var(--brand2));
  color: white;
  border: none;
  padding: 0.8rem;
  border-radius: 8px;
  font-family: 'Manrope', sans-serif;
  font-weight: 700;
  font-size: 0.92rem;
  cursor: pointer;
  transition: opacity 0.15s, transform 0.15s;
  box-shadow: 0 4px 14px rgba(0,87,184,0.3);
}
.btn-save:hover { opacity: 0.9; transform: translateY(-1px); }

/* â”€â”€ PAGES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.page { display: none; animation: fadeIn 0.35s ease; }
.page.active { display: block; }
@keyframes fadeIn { from { opacity:0; transform:translateY(6px); } to { opacity:1; transform:none; } }

/* â”€â”€ LANDING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.hero {
  background: linear-gradient(150deg, var(--dark) 0%, var(--dark2) 60%, #0d2a5e 100%);
  min-height: calc(100vh - 62px);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 4rem 2rem;
  position: relative;
  overflow: hidden;
}
.hero-grid-bg {
  position: absolute; inset: 0;
  background-image:
    linear-gradient(rgba(0,87,184,0.06) 1px, transparent 1px),
    linear-gradient(90deg, rgba(0,87,184,0.06) 1px, transparent 1px);
  background-size: 56px 56px;
}
.hero-glow {
  position: absolute;
  width: 700px; height: 700px;
  border-radius: 50%;
  background: radial-gradient(circle, rgba(0,114,229,0.13) 0%, transparent 65%);
  top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  pointer-events: none;
}
.hero-inner {
  max-width: 1000px;
  width: 100%;
  display: grid;
  grid-template-columns: 1.1fr 0.9fr;
  gap: 5rem;
  align-items: center;
  position: relative;
  z-index: 1;
}
.hero-eyebrow {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  background: rgba(0,180,216,0.1);
  border: 1px solid rgba(0,180,216,0.22);
  border-radius: 20px;
  padding: 5px 14px;
  font-size: 0.73rem;
  color: var(--accent);
  font-weight: 700;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  margin-bottom: 1.1rem;
}
.hero-eyebrow::before {
  content: '';
  width: 6px; height: 6px;
  border-radius: 50%;
  background: var(--accent);
}
.hero-text h1 {
  font-family: 'Manrope', sans-serif;
  font-size: 2.85rem;
  font-weight: 800;
  color: var(--white);
  line-height: 1.15;
  margin-bottom: 1.2rem;
}
.hero-text h1 span {
  background: linear-gradient(135deg, var(--accent), var(--brand2));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}
.hero-text p {
  color: rgba(255,255,255,0.58);
  font-size: 0.98rem;
  line-height: 1.78;
  margin-bottom: 2.2rem;
}
.hero-btns { display: flex; gap: 0.85rem; flex-wrap: wrap; }
.btn-primary {
  background: linear-gradient(135deg, var(--brand), var(--brand2));
  color: white;
  border: none;
  padding: 0.82rem 1.75rem;
  border-radius: var(--radius);
  font-family: 'Manrope', sans-serif;
  font-size: 0.94rem;
  font-weight: 700;
  cursor: pointer;
  transition: transform 0.15s, box-shadow 0.15s;
  box-shadow: 0 4px 16px rgba(0,87,184,0.35);
  display: inline-flex;
  align-items: center;
  gap: 7px;
}
.btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(0,87,184,0.45); }
.btn-ghost {
  background: transparent;
  color: rgba(255,255,255,0.68);
  border: 1.5px solid rgba(255,255,255,0.2);
  padding: 0.8rem 1.55rem;
  border-radius: var(--radius);
  font-family: 'Manrope', sans-serif;
  font-size: 0.94rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.15s;
}
.btn-ghost:hover { background: rgba(255,255,255,0.07); border-color: rgba(255,255,255,0.35); color: white; }

.hero-panel {
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.09);
  border-radius: 16px;
  padding: 1.8rem;
  backdrop-filter: blur(8px);
}
.hero-panel-label {
  font-size: 0.68rem;
  color: var(--accent);
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  margin-bottom: 1.2rem;
}
.flow-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.62rem 0;
  border-bottom: 1px solid rgba(255,255,255,0.06);
  font-size: 0.84rem;
}
.flow-row:last-child { border: none; }
.flow-lbl { color: rgba(255,255,255,0.42); }
.flow-val { font-weight: 600; }
.c-blue { color: var(--accent); }
.c-yellow { color: #fbbf24; }
.c-green { color: #34d399; }

/* â”€â”€ LOGIN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.auth-wrap {
  min-height: calc(100vh - 62px);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 3rem 1rem;
}
.auth-card {
  background: white;
  border-radius: 16px;
  box-shadow: var(--shadow-lg);
  padding: 2.4rem 2.6rem;
  width: 100%;
  max-width: 400px;
  border-top: 4px solid var(--brand);
}
.auth-logo-area { margin-bottom: 1.8rem; }
.auth-logo-area img { height: 38px; width: auto; margin-bottom: 0.9rem; display: block; }
.auth-logo-area h2 {
  font-family: 'Manrope', sans-serif;
  font-size: 1.18rem;
  font-weight: 700;
  color: var(--dark);
}
.auth-logo-area p { font-size: 0.82rem; color: var(--gray); margin-top: 0.22rem; }

.form-group { margin-bottom: 1.1rem; }
.form-group label {
  display: block;
  font-size: 0.79rem;
  font-weight: 600;
  color: var(--dark);
  margin-bottom: 0.38rem;
}
.form-group input {
  width: 100%;
  padding: 0.7rem 1rem;
  border: 1.5px solid var(--border);
  border-radius: var(--radius);
  font-family: 'Inter', sans-serif;
  font-size: 0.91rem;
  color: var(--dark);
  background: #FAFBFC;
  transition: border-color 0.2s, box-shadow 0.2s;
  outline: none;
}
.form-group input:focus {
  border-color: var(--brand2);
  box-shadow: 0 0 0 3px rgba(0,114,229,0.11);
  background: white;
}
.form-hint { font-size: 0.72rem; color: var(--gray); margin-top: 0.28rem; }
.btn-full { width: 100%; justify-content: center; margin-top: 0.5rem; }
.auth-link {
  display: block;
  margin-top: 1.1rem;
  text-align: center;
  font-size: 0.74rem;
  color: var(--gray);
}
.auth-link a { color: var(--brand2); text-decoration: none; font-weight: 600; }

/* â”€â”€ PAYMENT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.payment-wrap {
  max-width: 800px;
  margin: 0 auto;
  padding: 2.5rem 1.5rem 4rem;
}
.payment-header { margin-bottom: 1.6rem; }
.payment-header h2 {
  font-family: 'Manrope', sans-serif;
  font-size: 1.65rem;
  font-weight: 800;
  color: var(--dark);
  margin-bottom: 0.22rem;
}
.payment-header p { color: var(--gray); font-size: 0.86rem; }
.payment-grid {
  display: grid;
  grid-template-columns: 1.35fr 1fr;
  gap: 1.3rem;
  align-items: start;
}
.card-box {
  background: white;
  border-radius: 14px;
  box-shadow: var(--shadow);
  padding: 1.55rem;
  border: 1px solid rgba(0,0,0,0.04);
}
.card-box h3 {
  font-family: 'Manrope', sans-serif;
  font-size: 0.9rem;
  font-weight: 700;
  color: var(--dark);
  margin-bottom: 1.25rem;
  padding-bottom: 0.72rem;
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  gap: 7px;
}
/* Card visual */
.card-visual {
  background: linear-gradient(135deg, var(--dark) 0%, var(--dark2) 50%, #0d2a5e 100%);
  border-radius: 12px;
  padding: 1.3rem;
  margin-bottom: 1.3rem;
  color: white;
  position: relative;
  overflow: hidden;
  min-height: 146px;
}
.card-visual::before {
  content: '';
  position: absolute;
  top: -40px; right: -40px;
  width: 180px; height: 180px;
  border-radius: 50%;
  background: rgba(0,114,229,0.2);
}
.card-visual::after {
  content: '';
  position: absolute;
  bottom: -55px; right: 25px;
  width: 140px; height: 140px;
  border-radius: 50%;
  background: rgba(0,180,216,0.1);
}
.card-issuer {
  color: rgba(255,255,255,0.45);
  font-size: 0.68rem;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  margin-bottom: 1rem;
}
.card-num {
  font-size: 1.08rem;
  letter-spacing: 0.18em;
  font-weight: 300;
  margin-bottom: 0.9rem;
}
.card-footer { display: flex; justify-content: space-between; font-size: 0.75rem; }
.card-footer-lbl { color: rgba(255,255,255,0.38); font-size: 0.63rem; margin-bottom: 2px; }
.card-footer-val { color: white; font-weight: 500; }
/* Recording bar */
.rec-bar {
  border-radius: 9px;
  padding: 0.75rem 1rem;
  margin-bottom: 1.1rem;
  font-size: 0.79rem;
  display: flex;
  align-items: center;
  gap: 10px;
  border: 1px solid;
  line-height: 1.4;
}
.rec-bar.active { background: #fef9ec; border-color: #fde68a; color: #78350f; }
.rec-bar.paused { background: #f0fdf4; border-color: #bbf7d0; color: #14532d; }
.rec-bar.error  { background: #fef2f2; border-color: #fecaca; color: #7f1d1d; }
.pulse {
  width: 9px; height: 9px;
  border-radius: 50%;
  background: var(--danger);
  animation: blink 1.2s infinite;
  flex-shrink: 0;
}
.pulse.green { background: var(--success); animation: none; }
.pulse.off   { background: var(--gray);    animation: none; }
@keyframes blink { 0%,100%{opacity:1;} 50%{opacity:0.22;} }
/* Summary */
.sum-row {
  display: flex;
  justify-content: space-between;
  font-size: 0.84rem;
  padding: 0.48rem 0;
  border-bottom: 1px solid #f1f3f7;
  color: var(--gray);
}
.sum-row:last-child { border: none; }
.sum-row.total {
  font-weight: 700;
  color: var(--dark);
  font-size: 0.98rem;
  padding-top: 0.72rem;
}
.sum-row.total .amt { color: var(--brand); }
/* Webex status */
.wx-status { font-size: 0.79rem; }
.wx-row {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 8px;
  padding: 0.38rem 0;
  border-bottom: 1px solid #f1f3f7;
}
.wx-row:last-child { border: none; }
.wx-lbl { color: var(--gray); white-space: nowrap; }
.wx-val { font-weight: 600; color: var(--dark); font-size: 0.76rem; word-break: break-all; text-align: right; }
.sec-row { display: flex; flex-wrap: wrap; gap: 0.45rem; margin-top: 0.9rem; }
.sec-badge {
  background: var(--cream);
  border: 1px solid var(--border);
  border-radius: 5px;
  padding: 3px 9px;
  font-size: 0.68rem;
  color: var(--dark);
  font-weight: 500;
}
.info-box {
  background: #eff6ff;
  border: 1px solid #bfdbfe;
  border-radius: 9px;
  padding: 0.85rem 1rem;
  font-size: 0.75rem;
  color: #1e40af;
  line-height: 1.7;
}
/* Success */
.success-wrap {
  min-height: calc(100vh - 62px);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 2rem;
}
.success-card {
  background: white;
  border-radius: 16px;
  box-shadow: var(--shadow-lg);
  padding: 3rem 2.5rem;
  max-width: 460px;
  width: 100%;
  text-align: center;
}
.success-icon {
  width: 68px; height: 68px;
  background: linear-gradient(135deg, #059669, #34d399);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 1.4rem;
  font-size: 2rem;
  box-shadow: 0 8px 24px rgba(5,150,105,0.28);
}
.success-card h2 {
  font-family: 'Manrope', sans-serif;
  font-size: 1.65rem;
  font-weight: 800;
  color: var(--dark);
  margin-bottom: 0.5rem;
}
.success-card p {
  color: var(--gray);
  font-size: 0.87rem;
  line-height: 1.7;
  margin-bottom: 1.4rem;
}
.ref-box {
  background: var(--cream);
  border-radius: 8px;
  padding: 0.75rem 1rem;
  font-size: 0.78rem;
  color: var(--gray);
  margin-bottom: 1.4rem;
}
.ref-box strong { color: var(--dark); font-family: monospace; font-size: 0.85rem; }
/* Toast */
#toast {
  position: fixed;
  bottom: 1.8rem; left: 50%;
  transform: translateX(-50%) translateY(20px);
  background: var(--dark);
  color: white;
  padding: 0.75rem 1.4rem;
  border-radius: 9px;
  font-size: 0.83rem;
  box-shadow: var(--shadow-lg);
  z-index: 9999;
  opacity: 0;
  transition: all 0.3s;
  white-space: nowrap;
  border-left: 3px solid var(--brand2);
  pointer-events: none;
}
#toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }

@media (max-width: 680px) {
  .hero-inner { grid-template-columns: 1fr; gap: 2rem; }
  .hero-panel { display: none; }
  .payment-grid { grid-template-columns: 1fr; }
  .auth-card { padding: 1.8rem 1.3rem; }
  nav { padding: 0 1rem; }
  .hero-text h1 { font-size: 2rem; }
  .nav-product { display: none; }
}
```

  </style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     NAV
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<nav>
  <div class="nav-logo">
    <!--
      Logo file: place "CX Advanced Solutions.png" in the same folder as this HTML file.
      It will display automatically. Falls back to text if file not found.
    -->
    <img src="CX Advanced Solutions.png" alt="CX Advanced Solutions"
         onerror="this.style.display='none'; document.getElementById('logo-text').style.display='block'" />
    <span id="logo-text" class="nav-logo-fallback" style="display:none">CX Advanced Solutions</span>
    <div class="nav-logo-sep"></div>
    <span class="nav-product">Payment System</span>
  </div>
  <div class="nav-right">
    <div class="nav-user-pill" id="nav-user-pill"></div>
    <button id="gear-btn" onclick="openConfig()" title="Configure Webex API credentials">
      âš™ API Config
      <span class="gear-dot" id="gear-dot" title="Not configured"></span>
    </button>
  </div>
</nav>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     API CONFIG MODAL
     Opens from nav gear button or any "Configure API" link
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<div class="modal-backdrop" id="modal-backdrop" onclick="backdropClick(event)">
  <div class="modal">
    <div class="modal-header">
      <h3>âš™ &nbsp;Webex API Configuration</h3>
      <button class="modal-close" onclick="closeConfig()">âœ•</button>
    </div>
    <div class="modal-body">
      <div class="demo-notice">
        <strong>Demo Mode</strong> â€” Paste your Webex credentials below to enable live API calls
        (pause/resume recording). In production, replace with <strong>OAuth 2.0</strong>.
        Values are stored in memory only and reset on page reload.
      </div>

```
  <div class="cfg-status-row" id="cfg-status-row">
    <span class="status-dot" id="cfg-dot"></span>
    <span id="cfg-status-text">Not configured â€” API calls will simulate (demo mode)</span>
  </div>

  <div class="cfg-field">
    <label>Webex Bearer Token</label>
    <input type="password" id="cfg-token" placeholder="Paste your Bearer token hereâ€¦" autocomplete="off" />
    <div class="cfg-hint">Get from developer.webex.com â†’ "Copy personal access token" (valid 12 hrs), or use a Bot token</div>
  </div>

  <div class="cfg-field">
    <label>WxCC Org ID</label>
    <input type="text" id="cfg-org" placeholder="e.g. 1eb65fdf-9643-417f-9974-ad6bfa5e32a3" />
    <div class="cfg-hint">Control Hub â†’ Organization Settings â†’ Org ID</div>
  </div>

  <div class="cfg-field">
    <label>WxCC API Base URL</label>
    <input type="text" id="cfg-base" placeholder="https://api.wxcc-us1.cisco.com" />
    <div class="cfg-hint">Region-specific: us1 / eu1 / anz1 / jp1 etc. Leave blank for default (us1)</div>
  </div>

  <div class="cfg-field">
    <label>Task / Call ID &nbsp;<span style="text-transform:none;font-weight:400;color:rgba(255,255,255,0.25)">(optional override)</span></label>
    <input type="text" id="cfg-task" placeholder="Auto-resolved from agent lookup at login" />
    <div class="cfg-hint">Manually set a task ID to test pause/resume against a specific active call, without going through agent lookup</div>
  </div>
</div>
<div class="modal-footer">
  <button class="btn-save" onclick="saveConfig()">ğŸ’¾ &nbsp;Save &amp; Close</button>
</div>
```

  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PAGE 1 â€” LANDING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<div id="page-landing" class="page active">
  <section class="hero">
    <div class="hero-grid-bg"></div>
    <div class="hero-glow"></div>
    <div class="hero-inner">
      <div class="hero-text">
        <div class="hero-eyebrow">Webex Contact Center Demo</div>
        <h1>Secure, compliant <span>payment collection</span> for contact centers</h1>
        <p>Demonstrate how Webex Contact Center automatically pauses call recordings during card entry â€” then resumes when payment is complete â€” keeping customer data protected and agents PCI compliant.</p>
        <div class="hero-btns">
          <button class="btn-primary" onclick="showPage('login')">Start Payment Demo â†’</button>
          <button class="btn-ghost" onclick="openConfig()">âš™ Configure API First</button>
        </div>
      </div>
      <div class="hero-panel">
        <div class="hero-panel-label">ğŸ“‹ Demo Flow</div>
        <div class="flow-row"><span class="flow-lbl">Agent logs in</span><span class="flow-val c-blue">Email â†’ Webex lookup</span></div>
        <div class="flow-row"><span class="flow-lbl">Active call found</span><span class="flow-val c-blue">Task ID resolved</span></div>
        <div class="flow-row"><span class="flow-lbl">Card entry starts</span><span class="flow-val c-yellow">Recording PAUSED â¸</span></div>
        <div class="flow-row"><span class="flow-lbl">Payment completes</span><span class="flow-val c-green">Recording RESUMED â–¶</span></div>
        <div class="flow-row"><span class="flow-lbl">Card data captured</span><span class="flow-val c-green">Never âœ“</span></div>
        <br/>
        <button class="btn-primary" style="width:100%;justify-content:center;" onclick="showPage('login')">
          Try the Demo â†’
        </button>
      </div>
    </div>
  </section>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PAGE 2 â€” LOGIN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<div id="page-login" class="page">
  <div class="auth-wrap">
    <div class="auth-card">
      <div class="auth-logo-area">
        <img src="CX Advanced Solutions.png" alt="CX Advanced Solutions"
             onerror="this.style.display='none'" />
        <h2>Agent Sign In</h2>
        <p>Sign in with your Webex email to begin the payment flow</p>
      </div>
      <div class="form-group">
        <label>Webex Email / Username</label>
        <input type="email" id="login-email" placeholder="agent@yourcompany.com" autocomplete="email" />
        <div class="form-hint">Used to look up your Webex agent profile and active call task ID</div>
      </div>
      <div class="form-group">
        <label>Password</label>
        <input type="password" id="login-password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" />
      </div>
      <button class="btn-primary btn-full" onclick="handleLogin()">Sign In &amp; Continue â†’</button>
      <div class="auth-link">
        <a href="#" onclick="openConfig();return false;">âš™ Configure Webex API</a> before signing in to enable live API calls
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PAGE 3 â€” PAYMENT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<div id="page-payment" class="page">
  <div class="payment-wrap">
    <div class="payment-header">
      <h2>Secure Payment Collection</h2>
      <p>Recording pauses automatically when card details are entered</p>
    </div>

```
<div class="rec-bar active" id="rec-bar">
  <div class="pulse" id="rec-pulse"></div>
  <span id="rec-text">ğŸ”´ Call recording is active â€” will pause automatically when you begin entering card details</span>
</div>

<div class="payment-grid">
  <!-- LEFT â€” Payment form -->
  <div>
    <div class="card-box">
      <h3>ğŸ’³ Card Details</h3>
      <div class="card-visual">
        <div class="card-issuer">CXAS Secure Payment</div>
        <div class="card-num" id="card-display">â€¢â€¢â€¢â€¢ &nbsp;â€¢â€¢â€¢â€¢ &nbsp;â€¢â€¢â€¢â€¢ &nbsp;â€¢â€¢â€¢â€¢</div>
        <div class="card-footer">
          <div>
            <div class="card-footer-lbl">CARDHOLDER</div>
            <div class="card-footer-val" id="card-name-disp">FULL NAME</div>
          </div>
          <div>
            <div class="card-footer-lbl">EXPIRES</div>
            <div class="card-footer-val" id="card-exp-disp">MM/YY</div>
          </div>
        </div>
      </div>

      <div class="form-group">
        <label>Cardholder Name</label>
        <input type="text" id="f-name" placeholder="Jane Smith"
          oninput="document.getElementById('card-name-disp').textContent=(this.value||'FULL NAME').toUpperCase()" />
      </div>
      <div class="form-group">
        <label>Card Number</label>
        <input type="text" id="f-num" placeholder="1234 5678 9012 3456" maxlength="19"
          oninput="fmtCardNum(this)" onfocus="triggerPause()" />
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem">
        <div class="form-group">
          <label>Expiry</label>
          <input type="text" id="f-exp" placeholder="MM / YY" maxlength="7"
            oninput="fmtExpiry(this)" />
        </div>
        <div class="form-group">
          <label>CVV</label>
          <input type="text" id="f-cvv" placeholder="â€¢â€¢â€¢" maxlength="4" />
        </div>
      </div>

      <button class="btn-primary btn-full" id="pay-btn" onclick="handlePayment()" style="padding:0.92rem;font-size:0.95rem;">
        ğŸ”’ &nbsp;Complete Payment
      </button>
      <div class="sec-row">
        <span class="sec-badge">ğŸ”’ SSL Encrypted</span>
        <span class="sec-badge">âœ… PCI DSS Level 1</span>
        <span class="sec-badge">ğŸ›¡ Fraud Protected</span>
      </div>
    </div>
  </div>

  <!-- RIGHT â€” Summary + Webex status -->
  <div style="display:flex;flex-direction:column;gap:1.2rem;">
    <div class="card-box">
      <h3>ğŸ§¾ Payment Summary</h3>
      <div class="sum-row"><span>Service Fee</span><span>$12.99</span></div>
      <div class="sum-row"><span>Account Maintenance</span><span>$3.00</span></div>
      <div class="sum-row"><span>Paperless Discount</span><span style="color:var(--success)">âˆ’$1.00</span></div>
      <div class="sum-row"><span>Tax</span><span>$0.75</span></div>
      <div class="sum-row total"><span>Total Due</span><span class="amt">$15.74</span></div>
    </div>

    <div class="card-box">
      <h3>ğŸ“¡ Webex API Status</h3>
      <div class="wx-status">
        <div class="wx-row"><span class="wx-lbl">Agent Email</span><span class="wx-val" id="st-email">â€”</span></div>
        <div class="wx-row"><span class="wx-lbl">Agent ID</span><span class="wx-val" id="st-agent">â€”</span></div>
        <div class="wx-row"><span class="wx-lbl">Task ID</span><span class="wx-val" id="st-task">â€”</span></div>
        <div class="wx-row"><span class="wx-lbl">Recording</span><span class="wx-val" id="st-rec">Active â—</span></div>
        <div class="wx-row"><span class="wx-lbl">Mode</span><span class="wx-val" id="st-mode">Demo</span></div>
      </div>
      <div style="margin-top:1rem;">
        <button onclick="openConfig()" style="width:100%;background:var(--cream);border:1.5px solid var(--border);padding:0.5rem;border-radius:7px;font-size:0.77rem;cursor:pointer;font-family:'Inter',sans-serif;color:var(--dark);font-weight:600;display:flex;align-items:center;justify-content:center;gap:5px;">
          âš™ Edit API Config
        </button>
      </div>
    </div>

    <div class="card-box info-box" style="padding:0.9rem 1rem;">
      <strong>ğŸ” How it works:</strong> When "Complete Payment" is clicked, a <code>POST /recording/pause</code> fires to WxCC using the task ID resolved at login. On completion, <code>POST /recording/resume</code> is called â€” card data is never captured in the recording.
    </div>
  </div>
</div>
```

  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PAGE 4 â€” SUCCESS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<div id="page-success" class="page">
  <div class="success-wrap">
    <div class="success-card">
      <div class="success-icon">âœ“</div>
      <h2>Payment Complete!</h2>
      <p>
        Your payment of <strong>$15.74</strong> was processed successfully.<br/>
        Confirmation sent to <strong id="s-email">â€”</strong>
      </p>
      <div class="ref-box">Reference #: <strong id="s-ref">â€”</strong></div>
      <div class="rec-bar paused" style="text-align:left;margin-bottom:1.5rem;">
        <div class="pulse green"></div>
        <span>Call recording has been <strong>resumed</strong>. Card data was not captured.</span>
      </div>
      <button class="btn-primary btn-full" onclick="resetDemo()">â† Run Demo Again</button>
    </div>
  </div>
</div>

<!-- Toast -->

<div id="toast"></div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     JAVASCRIPT â€” Webex Integration

     QUICK START:
     1. Click "âš™ API Config" in the nav bar
     2. Paste your Webex Bearer token + Org ID
     3. Optionally override the Task ID for testing
     4. Sign in with an agent email to run the demo

     API CALL ORDER:
       Login  â†’ lookupAgentByEmail() â†’ findActiveTask()
       Pay    â†’ pauseRecording()     (fires on card focus too)
       Done   â†’ resumeRecording()

     For production: move all API calls to a server-side
     proxy and use OAuth 2.0 â€” never expose tokens client-side.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<script>
/* â”€â”€ Runtime config (populated by modal) â”€â”€â”€â”€â”€â”€â”€â”€ */
const CFG = {
  token:   '',
  orgId:   '',
  baseUrl: 'https://api.wxcc-us1.cisco.com',
  taskId:  '',
};

/* â”€â”€ App state â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const APP = { email:'', agentId:'', taskId:'', paused:false };

/* â”€â”€ Routing â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function showPage(name) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.getElementById('page-' + name).classList.add('active');
  window.scrollTo(0, 0);
}

/* â”€â”€ Config modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function openConfig() {
  document.getElementById('cfg-token').value = CFG.token;
  document.getElementById('cfg-org').value   = CFG.orgId;
  document.getElementById('cfg-base').value  = CFG.baseUrl !== 'https://api.wxcc-us1.cisco.com' ? CFG.baseUrl : '';
  document.getElementById('cfg-task').value  = CFG.taskId;
  document.getElementById('modal-backdrop').classList.add('open');
}
function closeConfig() {
  document.getElementById('modal-backdrop').classList.remove('open');
}
function backdropClick(e) {
  if (e.target.id === 'modal-backdrop') closeConfig();
}
function saveConfig() {
  CFG.token  = document.getElementById('cfg-token').value.trim();
  CFG.orgId  = document.getElementById('cfg-org').value.trim();
  CFG.baseUrl= document.getElementById('cfg-base').value.trim() || 'https://api.wxcc-us1.cisco.com';
  CFG.taskId = document.getElementById('cfg-task').value.trim();
  if (CFG.taskId) APP.taskId = CFG.taskId;

  const live = !!(CFG.token && CFG.orgId);
  document.getElementById('gear-dot').className       = 'gear-dot' + (live ? ' ok' : '');
  document.getElementById('cfg-dot').className        = 'status-dot' + (live ? ' ok' : '');
  document.getElementById('cfg-status-text').textContent = live
    ? 'âœ… Configured â€” live Webex API calls enabled'
    : 'Not configured â€” running in demo/simulation mode';
  document.getElementById('st-mode').textContent = live ? 'Live âœ“' : 'Demo';
  closeConfig();
  showToast(live ? 'âœ… API config saved â€” live mode enabled' : 'âš ï¸ Saved (demo mode â€” no token/org entered)');
}

/* â”€â”€ Login handler â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
async function handleLogin() {
  const email = document.getElementById('login-email').value.trim();
  const pass  = document.getElementById('login-password').value;
  if (!email) { showToast('âš ï¸ Please enter your email'); return; }
  if (!pass)  { showToast('âš ï¸ Please enter your password'); return; }

  APP.email = email;
  document.getElementById('nav-user-pill').textContent = email;
  document.getElementById('nav-user-pill').style.display = 'block';

  showToast('ğŸ” Looking up Webex agent profileâ€¦');
  try {
    await lookupAgentByEmail(email);
    await findActiveTask(APP.agentId);
  } catch(e) {
    console.warn('[Webex] Lookup failed, continuing demo mode:', e.message);
    APP.agentId = APP.agentId || 'demo-agent-id';
    APP.taskId  = APP.taskId  || CFG.taskId || 'DEMO-' + Math.random().toString(36).slice(2,8).toUpperCase();
    showToast('âš ï¸ API lookup failed â€” continuing in demo mode');
  }

  updateStatusPanel();
  showPage('payment');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   API CALL 1 â€” Lookup Agent by Email
   GET https://webexapis.com/v1/people?email={email}
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function lookupAgentByEmail(email) {
  if (!CFG.token) {
    console.log('[Demo] No token â€” skipping agent lookup');
    APP.agentId = 'demo-agent-id';
    return;
  }
  const res = await fetch(`https://webexapis.com/v1/people?email=${encodeURIComponent(email)}`, {
    headers: { 'Authorization': `Bearer ${CFG.token}`, 'Content-Type': 'application/json' }
  });
  if (!res.ok) throw new Error(`People API ${res.status}`);
  const data   = await res.json();
  const person = data.items?.[0];
  if (!person) throw new Error(`No Webex user found for ${email}`);
  APP.agentId = person.id;
  console.log('[Webex] Agent:', person.displayName, person.id);
  showToast(`ğŸ‘¤ Agent found: ${person.displayName}`);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   API CALL 2 â€” Find Active Task (Call)
   GET {baseUrl}/v1/contactCenter/tasks?agentId={id}&state=active

   âš ï¸  Verify this endpoint for your WxCC version.
   See: developer.webex.com/docs/contact-center
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function findActiveTask(agentId) {
  if (CFG.taskId) { APP.taskId = CFG.taskId; return; } // manual override
  if (!CFG.token || agentId === 'demo-agent-id') {
    APP.taskId = 'DEMO-' + Math.random().toString(36).slice(2,8).toUpperCase();
    return;
  }
  // â”€â”€ Replace path if your WxCC uses a different endpoint â”€â”€
  const url = `${CFG.baseUrl}/v1/contactCenter/tasks?agentId=${encodeURIComponent(agentId)}&state=active`;
  const res = await fetch(url, {
    headers: { 'Authorization': `Bearer ${CFG.token}`, 'Content-Type': 'application/json' }
  });
  if (!res.ok) throw new Error(`Tasks API ${res.status}`);
  const data = await res.json();
  const task = data.data?.[0] || data.items?.[0];
  if (!task) throw new Error('No active task found');
  APP.taskId = task.id;
  console.log('[Webex] Task ID:', APP.taskId);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   API CALL 3 â€” Pause Recording
   POST {baseUrl}/v1/contactCenter/tasks/{taskId}/recording/pause
   Body: { "reason": "PCI_PAYMENT" }

   âš ï¸  Confirm endpoint with your Cisco WxCC docs
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function pauseRecording() {
  if (APP.paused) return;
  console.log('[Webex] Pausing recording â†’ Task:', APP.taskId);

  if (CFG.token && APP.taskId && !APP.taskId.startsWith('DEMO-')) {
    try {
      const res = await fetch(`${CFG.baseUrl}/v1/contactCenter/tasks/${APP.taskId}/recording/pause`, {
        method: 'POST',
        headers: { 'Authorization': `Bearer ${CFG.token}`, 'Content-Type': 'application/json' },
        body: JSON.stringify({ reason: 'PCI_PAYMENT' })
      });
      if (!res.ok) throw new Error(`Pause ${res.status}`);
      console.log('[Webex] âœ… Recording paused via API');
    } catch(e) {
      console.error('[Webex] Pause failed:', e.message);
      setRecBar('error', 'âš ï¸ Could not pause recording â€” check API config and task ID');
      showToast('âš ï¸ Pause API failed â€” see browser console');
      return;
    }
  } else {
    console.log('[Demo] Simulating recording pause');
    await sleep(350);
  }

  APP.paused = true;
  setRecBar('paused', 'â¸ Recording PAUSED â€” card details are protected from recording');
  document.getElementById('st-rec').textContent = 'Paused â¸';
  showToast('â¸ Recording paused â€” safe to enter card details');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   API CALL 4 â€” Resume Recording
   POST {baseUrl}/v1/contactCenter/tasks/{taskId}/recording/resume
   Body: { "reason": "PAYMENT_COMPLETE" }
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function resumeRecording() {
  console.log('[Webex] Resuming recording â†’ Task:', APP.taskId);

  if (CFG.token && APP.taskId && !APP.taskId.startsWith('DEMO-')) {
    try {
      const res = await fetch(`${CFG.baseUrl}/v1/contactCenter/tasks/${APP.taskId}/recording/resume`, {
        method: 'POST',
        headers: { 'Authorization': `Bearer ${CFG.token}`, 'Content-Type': 'application/json' },
        body: JSON.stringify({ reason: 'PAYMENT_COMPLETE' })
      });
      if (!res.ok) throw new Error(`Resume ${res.status}`);
      console.log('[Webex] âœ… Recording resumed via API');
    } catch(e) {
      console.error('[Webex] Resume failed:', e.message);
      showToast('âš ï¸ Resume API failed â€” see browser console');
    }
  } else {
    console.log('[Demo] Simulating recording resume');
    await sleep(300);
  }

  APP.paused = false;
  document.getElementById('st-rec').textContent = 'Resumed â–¶';
}

/* â”€â”€ Payment flow â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function triggerPause() {
  pauseRecording(); // auto-pause on first card field focus
}

async function handlePayment() {
  const name = document.getElementById('f-name').value.trim();
  const num  = document.getElementById('f-num').value.trim();
  const exp  = document.getElementById('f-exp').value.trim();
  const cvv  = document.getElementById('f-cvv').value.trim();
  if (!name || !num || !exp || !cvv) { showToast('âš ï¸ Please fill in all card fields'); return; }

  await pauseRecording(); // ensure paused before processing

  const btn = document.getElementById('pay-btn');
  btn.textContent = 'â³ Processing paymentâ€¦';
  btn.disabled = true;
  showToast('ğŸ’³ Processingâ€¦');
  await sleep(2200);

  await resumeRecording(); // resume after done

  document.getElementById('s-email').textContent = APP.email;
  document.getElementById('s-ref').textContent   = 'CXAS-' + Date.now().toString(36).toUpperCase();
  showPage('success');
  showToast('âœ… Payment complete â€” recording resumed');
}

/* â”€â”€ UI helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function setRecBar(state, msg) {
  document.getElementById('rec-bar').className = 'rec-bar ' + state;
  document.getElementById('rec-pulse').className = 'pulse' + (state==='paused'?' green':state==='error'?' off':'');
  document.getElementById('rec-text').textContent = msg;
}
function updateStatusPanel() {
  document.getElementById('st-email').textContent = APP.email || 'â€”';
  document.getElementById('st-agent').textContent = APP.agentId
    ? (APP.agentId.length > 22 ? APP.agentId.slice(0,22)+'â€¦' : APP.agentId) : 'â€”';
  document.getElementById('st-task').textContent  = APP.taskId || 'â€”';
  document.getElementById('st-mode').textContent  = CFG.token ? 'Live âœ“' : 'Demo';
}
function resetDemo() {
  Object.assign(APP, {email:'', agentId:'', taskId:'', paused:false});
  ['login-email','login-password','f-name','f-num','f-exp','f-cvv'].forEach(id => {
    document.getElementById(id).value = '';
  });
  document.getElementById('pay-btn').textContent = 'ğŸ”’ Complete Payment';
  document.getElementById('pay-btn').disabled = false;
  document.getElementById('nav-user-pill').style.display = 'none';
  document.getElementById('card-name-disp').textContent = 'FULL NAME';
  document.getElementById('card-exp-disp').textContent = 'MM/YY';
  document.getElementById('card-display').textContent = 'â€¢â€¢â€¢â€¢ \u00A0â€¢â€¢â€¢â€¢ \u00A0â€¢â€¢â€¢â€¢ \u00A0â€¢â€¢â€¢â€¢';
  setRecBar('active', 'ğŸ”´ Call recording is active â€” will pause automatically when you begin entering card details');
  showPage('landing');
}
function showToast(msg, ms=3500) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  clearTimeout(window._t);
  window._t = setTimeout(() => t.classList.remove('show'), ms);
}
function sleep(ms) { return new Promise(r => setTimeout(r, ms)); }

/* â”€â”€ Card input formatters â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function fmtCardNum(inp) {
  let v = inp.value.replace(/\D/g,'').slice(0,16);
  inp.value = v.match(/.{1,4}/g)?.join(' ') || v;
  const d = v.length > 0
    ? v.slice(0,4).padEnd(4,'â€¢') + ' â€¢â€¢â€¢â€¢ â€¢â€¢â€¢â€¢ ' + (v.slice(12)||'â€¢â€¢â€¢â€¢')
    : 'â€¢â€¢â€¢â€¢ â€¢â€¢â€¢â€¢ â€¢â€¢â€¢â€¢ â€¢â€¢â€¢â€¢';
  document.getElementById('card-display').textContent = d;
}
function fmtExpiry(inp) {
  let v = inp.value.replace(/\D/g,'').slice(0,4);
  if (v.length >= 3) v = v.slice(0,2) + ' / ' + v.slice(2);
  inp.value = v;
  document.getElementById('card-exp-disp').textContent = v || 'MM/YY';
}
</script>

</body>
</html>
